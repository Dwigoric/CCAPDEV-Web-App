import{p as j,I as H,g as M,u as _,e as $,f as N,h as D,b as d,m as S,i as W,j as Z,k as G,l as K,V as L,_ as O,n as i,o as x,q as R,w as b,s as B,t as J,d as g,v as T,x as Q,y as X,z as Y,A as U,B as ee,C as ae,D as oe,r as te,c as z,a as F}from"./index-0034d016.js";import{m as se,V as q,a as ne}from"./VSelectionControl-210f8ad4.js";const E=j({indeterminate:Boolean,indeterminateIcon:{type:H,default:"$checkboxIndeterminate"},...se({falseIcon:"$checkboxOff",trueIcon:"$checkboxOn"})},"VCheckboxBtn"),A=M()({name:"VCheckboxBtn",props:E(),emits:{"update:modelValue":a=>!0,"update:indeterminate":a=>!0},setup(a,r){let{slots:s}=r;const n=_(a,"indeterminate"),l=_(a,"modelValue");function u(c){n.value&&(n.value=!1)}const p=$(()=>n.value?a.indeterminateIcon:a.falseIcon),f=$(()=>n.value?a.indeterminateIcon:a.trueIcon);return N(()=>{const c=D(q.filterProps(a),["modelValue"]);return d(q,S(c,{modelValue:l.value,"onUpdate:modelValue":[v=>l.value=v,u],class:["v-checkbox-btn",a.class],style:a.style,type:"checkbox",falseIcon:p.value,trueIcon:f.value,"aria-checked":n.value?"mixed":void 0}),s)}),{}}}),le=j({...W(),...D(E(),["inline"])},"VCheckbox"),re=M()({name:"VCheckbox",inheritAttrs:!1,props:le(),emits:{"update:modelValue":a=>!0,"update:focused":a=>!0},setup(a,r){let{attrs:s,slots:n}=r;const l=_(a,"modelValue"),{isFocused:u,focus:p,blur:f}=Z(a),c=G(),v=$(()=>a.id||`checkbox-${c}`);return N(()=>{const[V,h]=K(s),w=L.filterProps(a),k=A.filterProps(a);return d(L,S({class:["v-checkbox",a.class]},V,w,{modelValue:l.value,"onUpdate:modelValue":y=>l.value=y,id:v.value,focused:u.value,style:a.style}),{...n,default:y=>{let{id:P,messagesId:C,isDisabled:o,isReadonly:e,isValid:t}=y;return d(A,S(k,{id:P.value,"aria-describedby":C.value,disabled:o.value,readonly:e.value},h,{error:t.value===!1,modelValue:l.value,"onUpdate:modelValue":m=>l.value=m,onFocus:p,onBlur:f}),n)}})}),{}}}),ue={__name:"LoginForm",props:{buttonText:{type:String,required:!0},showConfirmPassword:{type:Boolean,required:!1,default:!1}},setup(a){const r=i(""),s=i(""),n=i(""),l=i(),u=i(!1),p=i("Invalid credentials"),f=i(!1),c=i(!1),v=i(!1),V=i(null),h=[o=>!!o||"Username is required",o=>o&&o.length<=20||"Username must be less than 20 characters",o=>/^[A-Za-z0-9]+$/.test(o)||"Username can only be alphanumeric"],w=[o=>!!o||"Password is required",o=>o&&o.length>=6||"Password must be at least 6 characters"],k=[...w,o=>o===s.value||"Passwords do not match"],y=async o=>{const e=ee(),{id:t}=ae(o),{user:m}=await fetch(`${U}/users/${t}`).then(I=>I.json()).catch(console.error);return e.id=m.id,e.username=m.username,e.image=m.image,u.value=!1,window.$cookies.set("credentials",{token:o,persist:!!v.value},v.value?"21d":0),oe.push({name:"feed"})},P=async()=>{const{valid:o}=await V.value.validate();if(!o)return;l.value=!0;const{token:e,message:t}=await fetch(`${U}/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:r.value,password:s.value})}).then(m=>m.json()).catch(console.error);if(!e){l.value=!1,u.value=!0,p.value=t;return}await y(e)},C=async()=>{const{valid:o}=await V.value.validate();if(!o)return;l.value=!0;const e=new URLSearchParams;e.set("key","username"),e.set("value",r.value);const{token:t,message:m}=await fetch(`${U}/auth/signup`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:r.value,password:s.value})}).then(I=>I.json()).catch(console.error);if(!t){l.value=!1,u.value=!0,p.value=m;return}await y(t)};return(o,e)=>(x(),R(Y,{id:"login-form",method:"post",onSubmit:e[8]||(e[8]=X(()=>{},["prevent"])),ref_key:"form",ref:V},{default:b(()=>[d(B,{class:"form-input",type:"text",name:"username",placeholder:"Username",rules:h,"validate-on":"input lazy",modelValue:r.value,"onUpdate:modelValue":e[0]||(e[0]=t=>r.value=t),modelModifiers:{lazy:!0}},null,8,["modelValue"]),d(B,{class:"form-input",type:f.value?"text":"password","append-inner-icon":f.value?"mdi-eye":"mdi-eye-off",name:"password",placeholder:"Password",rules:w,"validate-on":"input lazy",modelValue:s.value,"onUpdate:modelValue":e[1]||(e[1]=t=>s.value=t),modelModifiers:{lazy:!0},"onClick:appendInner":e[2]||(e[2]=t=>f.value=!f.value)},null,8,["type","append-inner-icon","modelValue"]),a.showConfirmPassword?(x(),R(B,{key:0,class:"form-input",type:c.value?"text":"password","append-inner-icon":c.value?"mdi-eye":"mdi-eye-off",name:"confirmPassword",placeholder:"Confirm Password",rules:k,"validate-on":"input lazy",modelValue:n.value,"onUpdate:modelValue":e[3]||(e[3]=t=>n.value=t),modelModifiers:{lazy:!0},"onClick:appendInner":e[4]||(e[4]=t=>c.value=!c.value)},null,8,["type","append-inner-icon","modelValue"])):J("",!0),d(re,{label:"Remember me",modelValue:v.value,"onUpdate:modelValue":e[5]||(e[5]=t=>v.value=t),class:"align-self-lg-start"},null,8,["modelValue"]),d(ne,{type:"error",closable:"closable",modelValue:u.value,"onUpdate:modelValue":e[6]||(e[6]=t=>u.value=t)},{default:b(()=>[g(T(p.value),1)]),_:1},8,["modelValue"]),d(Q,{type:"submit",rounded:"xl",size:"x-large",class:"ma-3",loading:l.value,onClick:e[7]||(e[7]=()=>{u.value=!1,a.showConfirmPassword?C():P()})},{default:b(()=>[g(T(a.buttonText),1)]),_:1},8,["loading"])]),_:1},512))}},ie=O(ue,[["__scopeId","data-v-fc49eb12"]]);const de={id:"loginBox"},ce={key:0,id:"signUpPrompt"},me={__name:"LoginBox",props:{buttonText:{type:String,required:!0},noRegisterPrompt:{type:Boolean,required:!1,default:!1},showConfirmPassword:{type:Boolean,required:!1,default:!1}},setup(a){return(r,s)=>{const n=te("RouterLink");return x(),z("div",de,[s[2]||(s[2]=F("div",{id:"loginHeader"},[g(" Welcome to "),F("span",{id:"title"},"Compact Donuts")],-1)),d(ie,{"button-text":a.buttonText,"show-confirm-password":a.showConfirmPassword},null,8,["button-text","show-confirm-password"]),a.noRegisterPrompt?J("",!0):(x(),z("div",ce,[s[1]||(s[1]=g(" Don't have an account? ")),d(n,{to:"/register"},{default:b(()=>s[0]||(s[0]=[g("Sign up")])),_:1})]))])}}},pe=O(me,[["__scopeId","data-v-4da729ac"]]);export{pe as L};
